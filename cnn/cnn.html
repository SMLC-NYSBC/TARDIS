

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CNN &mdash; TARDIS-em 0.3.10 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=9f76a604"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/dark_mode_js/default_dark.js?v=fd565c74"></script>
      <script src="../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CNN -&gt; Model" href="model.html" />
    <link rel="prev" title="CNN Module" href="../code_doc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            TARDIS-em
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Main:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#citation">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#what-s-new">What’s new?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#quick-start">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HISTORY.html">History</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../instructions.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/3d_actin.html">-  3D Actin Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/3d_mt.html">-  3D Microtubules Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/2d_mt.html">-  2D Microtubules Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/tirf_mt.html">-  TIRF Microtubules Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/3d_membrane.html">-  3D Membrane Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/2d_membrane.html">-  2D Membrane Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/scripting.html">-  Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/fine_tune_model.html">Fine-Tune TARDIS models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/helper.html">TARDIS helper-functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../code_doc.html">CNN Module</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">CNN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-tardis_em.cnn.cnn">CNN Model Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tardis_em.cnn.cnn.build_cnn_network"><code class="docutils literal notranslate"><span class="pre">build_cnn_network()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tardis_em.cnn.train">CNN Train Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tardis_em.cnn.train.train_cnn"><code class="docutils literal notranslate"><span class="pre">train_cnn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-tardis_em.cnn.trainer">CNN Trainer Wrapper</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tardis_em.cnn.trainer.CNNTrainer"><code class="docutils literal notranslate"><span class="pre">CNNTrainer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model.html">CNN Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html">DataLoader</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_processing.html">Data processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../code_doc.html#dist-module">DIST Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_doc.html#analysis-module">Analysis Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_doc.html#global-functions">Global Functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TARDIS-em</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../code_doc.html">CNN Module</a></li>
      <li class="breadcrumb-item active">CNN</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cnn/cnn.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cnn">
<h1>CNN<a class="headerlink" href="#cnn" title="Link to this heading"></a></h1>
<section id="module-tardis_em.cnn.cnn">
<span id="cnn-model-class"></span><h2>CNN Model Class<a class="headerlink" href="#module-tardis_em.cnn.cnn" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tardis_em.cnn.cnn.build_cnn_network">
<span class="sig-prename descclassname"><span class="pre">tardis_em.cnn.cnn.</span></span><span class="sig-name descname"><span class="pre">build_cnn_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tardis_em.cnn.cnn.build_cnn_network" title="Link to this definition"></a></dt>
<dd><p>Builds and returns an instance of a CNN-based network based on the provided
network type and configuration structure. The function supports various types
of networks such as UNet, ResUNet, UNet3Plus, FNet, and FNet with attention
mechanism. Each network type is associated with specific architectural
parameters outlined in the structure dictionary. The function validates the
input network type and configures the network based on the given attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network_type</strong> – The type of CNN network to build. Possible values are
“unet”, “resunet”, “unet3plus”, “fnet”, or “fnet_attn”.</p></li>
<li><p><strong>structure</strong> – A dictionary containing the structural parameters for the
network, including attributes like in_channel, out_channel, dropout,
conv_kernel, etc.</p></li>
<li><p><strong>img_size</strong> – An integer specifying the image patch size used in the
network. It defines the dimensions of the input image patches.</p></li>
<li><p><strong>prediction</strong> – A boolean indicating whether the network is used in
prediction mode or not. Affects specific layers or configurations in
the network instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the specified CNN network configured with the
provided attributes. Returns None if the input network type is invalid.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tardis_em.cnn.train">
<span id="cnn-train-module"></span><h2>CNN Train Module<a class="headerlink" href="#module-tardis_em.cnn.train" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tardis_em.cnn.train.train_cnn">
<span class="sig-prename descclassname"><span class="pre">tardis_em.cnn.train.</span></span><span class="sig-name descname"><span class="pre">train_cnn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_structure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bce'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stop_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tardis_em.cnn.train.train_cnn" title="Link to this definition"></a></dt>
<dd><p>This function trains a Convolutional Neural Network (CNN) using the provided
data loaders, model structure, and training parameters. It initializes the
model, sets up the training pipeline, and manages checkpoints, learning rate
schedulers, and optimization steps. The function supports retraining from
checkpoints and includes a variety of loss functions for customization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_dataloader</strong> (<em>torch.utils.data.DataLoader</em>) – A DataLoader used for training the CNN, containing
the training dataset.</p></li>
<li><p><strong>test_dataloader</strong> (<em>torch.utils.data.DataLoader</em>) – A DataLoader used for validation/testing the CNN,
containing the test dataset.</p></li>
<li><p><strong>model_structure</strong> (<em>dict</em>) – A dictionary defining the model’s structure, including
network type, input/output channels, and CNN configurations.</p></li>
<li><p><strong>checkpoint</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Optional path to a checkpoint file for retraining a
pre-existing model.</p></li>
<li><p><strong>loss_function</strong> (<em>str</em>) – Specifies the loss function to be used during training.
Defaults to “bce” (Binary Cross-Entropy). Available options include
AdaptiveDiceLoss, BCELoss, and others.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>) – The initial learning rate for the optimizer. Defaults
to 1. Higher or lower values can impact model convergence.</p></li>
<li><p><strong>learning_rate_scheduler</strong> (<em>bool</em>) – Boolean flag indicating whether to use a
learning rate scheduler during training. Defaults to False.</p></li>
<li><p><strong>early_stop_rate</strong> (<em>int</em>) – The number of consecutive epochs of non-improvement
in validation metrics before early stopping occurs. Defaults to 10.</p></li>
<li><p><strong>device</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>torch.device</em><em>]</em>) – The computational device to run the training on. Can be “gpu”,
“cpu”, or a torch.device instance. Defaults to “gpu”.</p></li>
<li><p><strong>warmup</strong> (<em>int</em>) – The number of warmup steps for the optimizer, used when
a learning rate scheduler is enabled. Defaults to 100.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – The maximum number of training epochs. Defaults to 1000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tardis_em.cnn.trainer">
<span id="cnn-trainer-wrapper"></span><h2>CNN Trainer Wrapper<a class="headerlink" href="#module-tardis_em.cnn.trainer" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="tardis_em.cnn.trainer.CNNTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tardis_em.cnn.trainer.</span></span><span class="sig-name descname"><span class="pre">CNNTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tardis_em.cnn.trainer.CNNTrainer" title="Link to this definition"></a></dt>
<dd><p>Class for training and validation of a Convolutional Neural Network (CNN).</p>
<p>Handles the entire process of training and validating a CNN model, including
data loading, forward and backward passes, evaluation, progress tracking, and
parameter updates. Designed to work with various configurations such as
classification tasks, learning rate scheduling, and early stopping based on
evaluation metrics.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../code_doc.html" class="btn btn-neutral float-left" title="CNN Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="model.html" class="btn btn-neutral float-right" title="CNN -&gt; Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024, Robert Kiewisz, Tristan Bepler.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>